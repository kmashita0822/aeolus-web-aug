var H=Object.defineProperty;var N=(c,e,s)=>e in c?H(c,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):c[e]=s;var f=(c,e,s)=>N(c,typeof e!="symbol"?e+"":e,s);import{r as E}from"./react-vendor-BeLYVh7p.js";import{R as W,V as $,a as y,S as D,C as M,P as Y,W as q,M as J,b as X,c as Q,B as Z,F as b,d as K,e as tt}from"./three-vendor-Cl1Gu39y.js";var O={exports:{}},S={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var et=Symbol.for("react.transitional.element"),st=Symbol.for("react.fragment");function C(c,e,s){var a=null;if(s!==void 0&&(a=""+s),e.key!==void 0&&(a=""+e.key),"key"in e){s={};for(var i in e)i!=="key"&&(s[i]=e[i])}else s=e;return e=s.ref,{$$typeof:et,type:c,key:a,ref:e!==void 0?e:null,props:s}}S.Fragment=st;S.jsx=C;S.jsxs=C;O.exports=S;var rt=O.exports;function nt(c){return c}function it(c){if(c==null)return nt;var e,s,a=c.scale[0],i=c.scale[1],l=c.translate[0],u=c.translate[1];return function(p,d){d||(e=s=0);var h=2,r=p.length,t=new Array(r);for(t[0]=(e+=p[0])*a+l,t[1]=(s+=p[1])*i+u;h<r;)t[h]=p[h],++h;return t}}function at(c,e){for(var s,a=c.length,i=a-e;i<--a;)s=c[i],c[i++]=c[a],c[a]=s}function ot(c,e){var s=it(c.transform),a=c.arcs;function i(r,t){t.length&&t.pop();for(var n=a[r<0?~r:r],o=0,m=n.length;o<m;++o)t.push(s(n[o],o));r<0&&at(t,m)}function l(r){return s(r)}function u(r){for(var t=[],n=0,o=r.length;n<o;++n)i(r[n],t);return t.length<2&&t.push(t[0]),t}function p(r){for(var t=u(r);t.length<4;)t.push(t[0]);return t}function d(r){return r.map(p)}function h(r){var t=r.type,n;switch(t){case"GeometryCollection":return{type:t,geometries:r.geometries.map(h)};case"Point":n=l(r.coordinates);break;case"MultiPoint":n=r.coordinates.map(l);break;case"LineString":n=u(r.arcs);break;case"MultiLineString":n=r.arcs.map(u);break;case"Polygon":n=d(r.arcs);break;case"MultiPolygon":n=r.arcs.map(d);break;default:return null}return{type:t,coordinates:n}}return h(e)}function ct(c,e){var s={},a={},i={},l=[],u=-1;e.forEach(function(h,r){var t=c.arcs[h<0?~h:h],n;t.length<3&&!t[1][0]&&!t[1][1]&&(n=e[++u],e[u]=h,e[r]=n)}),e.forEach(function(h){var r=p(h),t=r[0],n=r[1],o,m;if(o=i[t])if(delete i[o.end],o.push(h),o.end=n,m=a[n]){delete a[m.start];var g=m===o?o:o.concat(m);a[g.start=o.start]=i[g.end=m.end]=g}else a[o.start]=i[o.end]=o;else if(o=a[n])if(delete a[o.start],o.unshift(h),o.start=t,m=i[t]){delete i[m.end];var w=m===o?o:m.concat(o);a[w.start=m.start]=i[w.end=o.end]=w}else a[o.start]=i[o.end]=o;else o=[h],a[o.start=t]=i[o.end=n]=o});function p(h){var r=c.arcs[h<0?~h:h],t=r[0],n;return c.transform?(n=[0,0],r.forEach(function(o){n[0]+=o[0],n[1]+=o[1]})):n=r[r.length-1],h<0?[n,t]:[t,n]}function d(h,r){for(var t in h){var n=h[t];delete r[n.start],delete n.start,delete n.end,n.forEach(function(o){s[o<0?~o:o]=1}),l.push(n)}}return d(i,a),d(a,i),e.forEach(function(h){s[h<0?~h:h]||l.push([h])}),l}function ht(c){return ot(c,lt.apply(this,arguments))}function lt(c,e,s){var a,i,l;if(arguments.length>1)a=ut(c,e,s);else for(i=0,a=new Array(l=c.arcs.length);i<l;++i)a[i]=i;return{type:"MultiLineString",arcs:ct(c,a)}}function ut(c,e,s){var a=[],i=[],l;function u(t){var n=t<0?~t:t;(i[n]||(i[n]=[])).push({i:t,g:l})}function p(t){t.forEach(u)}function d(t){t.forEach(p)}function h(t){t.forEach(d)}function r(t){switch(l=t,t.type){case"GeometryCollection":t.geometries.forEach(r);break;case"LineString":p(t.arcs);break;case"MultiLineString":case"Polygon":d(t.arcs);break;case"MultiPolygon":h(t.arcs);break}}return r(e),i.forEach(s==null?function(t){a.push(t[0].i)}:function(t){s(t[0].g,t[t.length-1].g)&&a.push(t[0].i)}),a}function dt(){const[c,e]=E.useState(!1);return E.useEffect(()=>{const s=()=>{e(window.innerWidth<=768)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),c}const j=4210752,pt=16761600,k=[{color:16761600,strength:.08},{color:16761600,strength:.12},{color:16761600,strength:.18}],ft=400,mt=3,T=1200,wt=.35,gt=.5,yt=.15,vt=.22;class Mt{constructor(e,s){f(this,"radius",1.25);f(this,"sizes",{width:window.innerWidth,height:window.innerHeight});f(this,"isMobile");f(this,"scene");f(this,"camera");f(this,"renderer");f(this,"particles");f(this,"sphere");f(this,"raycaster",new W);f(this,"mouse",new $);f(this,"hitPoint",new y(999,999,999));f(this,"pulses",[]);f(this,"lastPulse",0);f(this,"onMouseMove",e=>{this.mouse.x=e.clientX/this.sizes.width*2-1,this.mouse.y=-(e.clientY/this.sizes.height)*2+1,this.particles&&this.sphere.rotation.copy(this.particles.rotation),this.raycaster.setFromCamera(this.mouse,this.camera);const s=this.raycaster.intersectObject(this.sphere)[0];this.hitPoint.copy(s?s.point:new y(999,999,999))});f(this,"onResize",()=>{this.sizes.width=window.innerWidth,this.sizes.height=window.innerHeight,this.camera.aspect=this.sizes.width/this.sizes.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.sizes.width,this.sizes.height)});f(this,"animate",()=>{if(requestAnimationFrame(this.animate),!this.particles)return;this.particles.rotation.y+=8e-4;const e=performance.now();if(e-this.lastPulse>ft){this.lastPulse=e;for(let r=0;r<mt;r++)this.spawnPulse()}this.pulses=this.pulses.filter(r=>e-r.start<T);const s=this.particles.geometry.getAttribute("position"),a=this.particles.geometry.getAttribute("initialPosition"),i=this.particles.geometry.getAttribute("normalOut"),l=this.particles.geometry.getAttribute("tangentOut"),u=this.particles.geometry.getAttribute("color"),p=this.particles.matrixWorld,d=new M(j),h=new M(pt);for(let r=0;r<s.count;r++){const t=r*3,n=new y(s.array[t],s.array[t+1],s.array[t+2]),o=new y(a.array[t],a.array[t+1],a.array[t+2]),m=new y(i.array[t],i.array[t+1],i.array[t+2]),g=new y(l.array[t],l.array[t+1],l.array[t+2]),w=n.clone().applyMatrix4(p),V=w.distanceTo(this.hitPoint),P=Math.max(0,1-V/gt),G=P*yt,I=P*vt;let L=0,x=0,A=null;for(const z of this.pulses){const _=1-(e-z.start)/T,U=w.distanceTo(z.center),R=Math.max(0,1-U/wt)*_*_*z.str;R>x&&(x=R,L=R*.8,A=z.col)}const B=o.clone().addScaledVector(g,G+L).addScaledVector(m,I+x),F=P>0?.18:x>.001?.15:.05;n.lerp(B,F),s.array[t]=n.x,s.array[t+1]=n.y,s.array[t+2]=n.z;let v=d;P>0?v=h:A&&(v=A),u.array[t]+=(v.r-u.array[t])*.14,u.array[t+1]+=(v.g-u.array[t+1])*.14,u.array[t+2]+=(v.b-u.array[t+2])*.14}s.needsUpdate=!0,u.needsUpdate=!0,this.renderer.render(this.scene,this.camera)});this.isMobile=s,this.scene=new D,this.scene.background=new M(0),this.camera=new Y(70,this.sizes.width/this.sizes.height,1,1e3),this.camera.position.z=s?3.5:3,this.renderer=new q({canvas:e,antialias:!0,powerPreference:"high-performance"}),this.renderer.setSize(this.sizes.width,this.sizes.height),this.renderer.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.sphere=new J(new X(this.radius,32,32),new Q({visible:!1})),this.scene.add(this.sphere),this.init(),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("resize",this.onResize)}async init(){try{const e=await fetch("https://cdn.jsdelivr.net/npm/world-atlas@1/world/50m.json").then(h=>h.json()),s=ht(e,e.objects.land),a=[],i=[],l=[],u=[],p=new M(j);for(const h of s.coordinates){const r=h.length;for(let t=0;t<r;t++){const n=this.toSphere(h[t]),o=this.toSphere(h[(t-1+r)%r]),g=this.toSphere(h[(t+1)%r]).clone().sub(o).normalize(),w=n.clone().normalize();a.push(n.x,n.y,n.z),i.push(w.x,w.y,w.z),l.push(g.x,g.y,g.z),u.push(p.r,p.g,p.b)}}const d=new Z;d.setAttribute("position",new b(a,3)),d.setAttribute("initialPosition",new b([...a],3)),d.setAttribute("normalOut",new b(i,3)),d.setAttribute("tangentOut",new b(l,3)),d.setAttribute("color",new b(u,3)),this.particles=new K(d,new tt({vertexColors:!0,size:this.isMobile?.007:.005,sizeAttenuation:!0})),this.scene.add(this.particles),this.animate()}catch(e){console.error("Failed to initialize globe:",e)}}toSphere(e){const[s,a]=e,i=s*Math.PI/180,l=a*Math.PI/180;return new y(this.radius*Math.cos(l)*Math.cos(i),this.radius*Math.sin(l),-this.radius*Math.cos(l)*Math.sin(i))}spawnPulse(){const e=Math.random(),s=Math.random(),a=2*Math.PI*e,i=Math.acos(2*s-1),l=new y(this.radius*Math.sin(i)*Math.cos(a),this.radius*Math.sin(i)*Math.sin(a),this.radius*Math.cos(i)),u=k[Math.floor(Math.random()*k.length)];this.pulses.push({center:l,start:performance.now(),col:new M(u.color),str:u.strength})}dispose(){window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("resize",this.onResize),this.particles&&(this.scene.remove(this.particles),this.particles.geometry.dispose(),this.particles.material.dispose()),this.scene.remove(this.sphere),this.sphere.geometry.dispose(),this.sphere.material.dispose(),this.renderer.dispose()}}function bt(){const c=E.useRef(null),e=E.useRef(null),s=dt();return E.useEffect(()=>(c.current&&(e.current=new Mt(c.current,s)),()=>{e.current&&(e.current.dispose(),e.current=null)}),[s]),rt.jsx("canvas",{ref:c,className:"w-full h-full block select-none"})}const At=Object.freeze(Object.defineProperty({__proto__:null,default:bt},Symbol.toStringTag,{value:"Module"}));export{At as G,rt as j};
//# sourceMappingURL=globe-component-CB00IpeK.js.map
